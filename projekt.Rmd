---
title: "Avtomobilizem v Evropi"
author: "Jaka Munda"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

V projektu bom obravnaval značilnosti avtomobilizma v Evropi in napovedal trende avtomobilizma za prihodnjih nekaj let. Pri tem bom obravnaval starost, težo, velikost motorjev, koliko emisij izpustijo v okolje ter kakšne vrste goriv uporabljajo. Prav tako bom pogledal razširjenost avtomobilov in avtomobilskih znamk v Evropi ter kakšna bo ta v prihodnosti.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```
Podatke sem uvozil v obliki CSV z erostata ter v obliki HTML z http://carsalesbase.com/european-car-sales-data/.
Podatke imam v večih razpredelnicah v obliki *tidy data*.

Velikost motorja - podatki o velikostih motorjev v avtomobilih po državah

- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Vrsta goriva - spremenljivka: dizel ali bencin
- 4.stolpec: Velikost motorja - spremenljivka: 4 različne velikosti motorjev
- 5.stolpec: Število - meritev

Teža avtomobilov - podatki o teži avtomobilov

- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Teža - spremenljivka: 4 razredi za težo
- 4.stolpec: Število - meritev

Vrste goriv - podatki o tem kakšne vrste goriva uporabljajo v posameznih državah
- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Vrsta goriva - spremenljivka: 5 različnih vrst goriva obravnavam
- 4.stolpec: Število - meritev

Starost avtomobilov - podatki o starostih avtomobilov po državah

- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Starost - spremenljivka: 4 starostni razredi
- 4.stolpec: Število - meritev

Emisije CO2 novih avtomobilov - podatki o emisijah CO2 po posameznih državah

- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Gram CO2 na km - meritev

Število avtomobilov na 1000 prebivalcev - podatki o razširjenosti avtomobilov po evropskih državah

- 1.stolpec: Država - spremenljivka
- 2.stolpec: Leto - spremenljvka
- 3.stolpec: Število - meritev: število avtomobilov na 1000 prebivalcev

Avtomobilske znamke - podatki o prodajanosti posameznih avtomobilskih znamk

- 1.stolpec: Avtomobilska znamka - spremenljivka
- 2.stolpec: Leto - spremenljivka
- 3.stolpec: Število prodanih avtomobilov - meritev
- 4.stolpec: Delež na trgu - meritev: delež prodanih avtomobilov na trgu


***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```
V vizualizaciji sem se nnajprej posvetil avtomobilskim znamkam in hitro prišel do sklepa, da avtomobilske znamke, kot so Volkswagen in Citroen prodajo bistveno več avtomobilov na letni ravni, kot pa znamke tipa Mercedes Benz, katerih avtomobili so veliko dražji. Sklepam da razlog za tako razliko tiči ravno v ceni. Dodajam še graf v katerem se vidijo te razlike.

print(graf_primerjava)

Pri obravnavi starosti avtomobilov sem ugotovil da v Evropi prevladujejo starejši avtomobili, od 5 let naprej. 
To se prikazal z grafom nemčije.

print(starost_nemcija)

Za tezo avtomobilov sem ugotovil da so v preteklosti prevladovali lažžji avtomobili(lazji od 1000 kg), vendar se je to s časom spremenilo tako da danes prevladujejo srednje težki avtomobili(med tono in tono in pol). Prav tako se je dvignilo število najtežjih avtomobilov teh je namreč enako kot tistih lažjih. Dvigovanje teže avtomobilov se mi zdi logično saj so sodobni avtomobili vedno bolje opremljeni, kar daje dodatno težo avtomobilu. 
Dodajam graf Francije, kjer se ta trend zelo dobro vidi. 

print(teza_francija)

Pri anlizi goriv sem ugotovil, da sta bencin in dizel še vedno najbol uporabljani vrsti goriva medtem ko so alternativne vrste energije zelo nerazširjene.

print(goriva_sever)

Spodnji zemljevid prikazuje stevilo avtomobilov na 1000 prebivalcev. Iz zemljevida vidimo da imajo vzhodne in jogovhodne evropske države manše število avtomobilov. Menim da je temu tako, ker so te države manj razvite od zahodno evropskih držav in imajo prebivalci teh držav manj denarja in si posledično ne morejo toliko privoščit, kot ljudje, ki živijo na zahodu Evrope. 

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid avtomobilov na 1000 prebivalcev'}
ggplot() + geom_polygon(data = left_join(evropa, st_na_1000_prebivalcev %>% filter(Leto == 2012),
                                         by = c("SOVEREIGNT" = "Drzava")), 
                        aes(x = long, y = lat, group = group, fill = Stevilo)) + 
  coord_map(xlim = c(-25, 40), ylim = c(32, 72)) + 
  labs(title="Stevilo avtomobilov \n na 1000 prebivalcev leta 2012",x="",y="") +
  theme(plot.title = element_text(hjust = 0.5))
```

Spodnji zemljevid prikazauje emisije CO2 leta 2016. 

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid emisij v letu 2016'}
ggplot() + geom_polygon(data = left_join(evropa,emisije %>% filter(Leto == 2016),
                                         by = c("SOVEREIGNT" = "Drzava")),
                        aes(x = long, y = lat, group = group, fill = Gram_CO2_na_km)) +
  coord_map(xlim = c(-25, 40), ylim = c(32, 72)) + labs(x="",y="") 
```


***


